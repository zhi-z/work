#  msOS入门

使用面向对象的方法来编写程序，msOS的界面与业务分开，即低速的在后台执行，可以被高速的、需要实时响应的业务所打断。

## 1 基本框架：

顶层为（菜单、App（数据）、业务处理）

中间层，即系统层（含有操作系统OS、图形用户界面GUI、Modbus协议还有PID控制算法模块）

底层驱动库函数（如定时器、ADC、串口、LCD等底层驱动函数）

内核了（其内核采用了Core—M3的内核）

## 2 系统框架的理解

该架构又称为前后台架构，那么这个前后台的架构是怎么运行的呢？我的理解是这样的：该系统跑两个大循环，一个跑的是需快速响应的，即前台，比如说按键的检测；另一个大循环跑的是响应速度相对较慢的业务，专门处理业务逻辑的，即后台，例如显示页面菜单。现就按键检测来解释其运行方式，该系统中前台的响应速度是10ms，也就是说，每10MS会进入中断进行一次按键检测，当有按下时，记录了这一次的按键状态，然后就退出中断，然后等到下一个10MS到来时，发现按键的状态和前10MS时刻的按键状态是一样的，说明确实有按键按下。这里有必要说明的是这里的10MS中断只是抛出按键的消息，进入中断，抛出这一时刻按键状态的消息，退出中断，等待下一个10MS再次进入中断抛出消息，两次消息记录的按键状态是一样的话就可以确定按键按下，这样做的好处就是不会使CPU空等10MS而不去做其他事情，浪费CPU资源，甚至导致系统崩溃（每10MS就进中断，若CPU进中断后出来10MS内不做其他事情而空等待，10MS来了又进中断，系统就会崩溃了）。这个10MS中断就相当于10MS定时器中断，在中断来之前CPU可以执行大循环里的其他东西，响应中断后就抛出消息，完全不占用CPU的时间。在系统中不止这么一个按键的检测消息，还有许多消息要传达，它是把消息装进一个队列里，遵循着先进先出的原则，也符合我们的实际逻辑。 